{"ast":null,"code":"var _jsxFileName = \"/mnt/Data/Javascript_code/Ionic/coffee-db4/src/components/frontend/add-items.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { IonPage, IonCard, IonHeader, IonToolbar, IonBackButton, IonContent, IonTitle, IonButtons, IonTextarea, IonCardContent, IonLabel, IonItem, IonInput, IonGrid, IonRow, IonCol, IonIcon, IonButton, IonImg, IonSelect, IonSelectOption } from '@ionic/react';\nimport { trash, save, camera, cameraReverse } from 'ionicons/icons';\nimport { beansDataFileName, beansSettingsFileName } from '../objects/filenames';\nimport { storeData, readPicture } from '../backend/data';\nimport { store } from '../backend/store';\nimport { useCamera, availableFeatures } from '@ionic/react-hooks/camera';\nimport { CameraResultType, Filesystem, FilesystemDirectory } from '@capacitor/core';\nexport const AddItems = (fileName, type) => {\n  console.log('******************* ADD-ITEMS *******************');\n  const globalState = useContext(store);\n  const {\n    state,\n    dispatch\n  } = globalState;\n  const [newArray, setNewArray] = useState(state[type].settings.map((arrayItem, index) => arrayItem.concat([index, ''])));\n  const dataString = 'set' + type.charAt(0).toUpperCase() + type.slice(1) + 'Data'; //returns either 'setBeansData' or 'setBrewsData'\n\n  const pictureString = 'set' + type.charAt(0).toUpperCase() + type.slice(1) + 'Pics'; //const [newArray, setNewArray] = useState(array.map((arrayItem, index) => arrayItem.concat([index, ''])))\n  // example of arrray ['Bean', true, 0, '']\n  // => Bean is the field title; true if it should be disalayed; 0 is the index; '' will be filled with content eg. Malabar \n\n  console.log(newArray);\n  const [inputValues, setInputValues] = useState(JSON.parse(JSON.stringify(newArray)));\n  let {\n    photo,\n    getPhoto\n  } = useCamera();\n  const [myPhoto, setMyPhoto] = useState(photo);\n\n  const handleTakePhoto = async () => {\n    if (availableFeatures.getPhoto) {\n      await getPhoto({\n        quality: 100,\n        allowEditing: false,\n        resultType: CameraResultType.DataUrl,\n        height: 1000\n      }); //console.log('inputvalues:', inputValues)\n      //setNewArray(inputValues.map( (arrayItem, index) => arrayItem[3] = inputValues[index][3]))  That's where I stopped\n      //setMyPhoto(photo)\n      //console.log('photo', photo)\n    }\n  };\n\n  useEffect(() => setMyPhoto(photo), [photo]);\n\n  const delFunc = () => {\n    //console.log('newarray1:',newArray)\n    setInputValues(inputValues.map(arrayItem => arrayItem.splice(0, 3).concat([''])));\n    console.log('inputvalueSSS:', inputValues); //setNewArray()\n\n    setMyPhoto(undefined); //console.log('newarray2:',newArray)\n  };\n\n  const saveIt = async (fileName, array, photo, type) => {\n    console.log('PHOTO::::::::::', photo); // https://stackoverflow.com/questions/42974735/create-object-from-array\n\n    const objectToSave = array.reduce((o, arrayItem) => ({ ...o,\n      [arrayItem[0]]: arrayItem[3]\n    }), {});\n    const objectWithID = await storeData(fileName, objectToSave, photo);\n    state[type].data.push(objectWithID);\n    dispatch({\n      type: dataString,\n      value: state[type].data\n    });\n    console.log('OBJECT WITH ID!!!!!!!!!', objectWithID);\n    console.log('FILENAME:', fileName);\n    const folder1 = fileName.split('/')[0];\n    console.log((await Filesystem.readdir({\n      directory: FilesystemDirectory.External,\n      path: folder1\n    })));\n    debugger;\n\n    if (photo) {\n      //if no picture is done photo will be undefined\n      const folder = fileName.split('/')[0];\n      const pathToPhoto = await readPicture(folder + '/' + objectWithID.id.toString() + '.jpeg');\n      console.log(\"saveIt -> folder + '/' + objectWithID.id.toString() + '.jpeg'\", folder + '/' + objectWithID.id.toString() + '.jpeg');\n      console.log(\"saveIt -> objectWithID.id.toString()\", objectWithID.id.toString());\n      console.log(\"saveIt -> pathToPhoto\", pathToPhoto);\n\n      if (pathToPhoto) {\n        dispatch({\n          type: pictureString,\n          value: pathToPhoto\n        });\n      }\n    } // const folder = beansDataFileName.split('/')[0]\n    //does delfunc delete everything even the ''photo''?\n\n\n    delFunc();\n    /*\n            // Pics Beans\n    if(beansData.length > 0){\n      let tempBeansPics = {}\n      for (let i=0; i<beansData.length; i++){\n        const temp = await readPicture(folder + '/' + beansData[i].id.toString() + '.jpeg')\n        console.log('TEMP', temp)\n        tempBeansPics[beansData[i].id]=temp\n        console.log('TEMPBEANSPICS:',tempBeansPics)\n      }\n      if(Object.keys(tempBeansPics).length > 0){\n        beansPics.push(tempBeansPics)\n      }\n    }\n    */\n  };\n\n  console.log('BEANSSETTINGS:', state.beans.settings);\n  console.log('BREWSSETTINGS:', state.brews.settings); //heir geht's los\n\n  const result = inputValues.filter(arrayItem => arrayItem[1]).map(arrayItem => {\n    if (type === 'brews' && state.beans.settings.filter(line => line[0] === arrayItem[0] && line[1]).length > 0 && arrayItem[0] !== 'Kommentar') {\n      console.log(state.beans.settings.filter(line => line[0] === arrayItem[0] && line[1]).length);\n      console.log('test');\n      return /*#__PURE__*/React.createElement(IonItem, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(IonLabel, {\n        position: \"stacked\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }\n      }, arrayItem[0], \":\"), /*#__PURE__*/React.createElement(IonSelect, {\n        name: arrayItem[0],\n        id: arrayItem[2],\n        value: arrayItem[3],\n        onIonChange: e => {\n          inputValues[e.target.id][3] = e.detail.value;\n          setInputValues(inputValues);\n          console.log(inputValues);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }\n      }, state.beans.data.map(line => /*#__PURE__*/React.createElement(IonSelectOption, {\n        value: line[arrayItem[0]],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }\n      }, line[arrayItem[0]]))));\n    } else {\n      return /*#__PURE__*/React.createElement(IonItem, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(IonLabel, {\n        position: \"stacked\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }\n      }, arrayItem[0], \":\"), /*#__PURE__*/React.createElement(IonInput, {\n        name: arrayItem[0],\n        id: arrayItem[2],\n        value: arrayItem[3],\n        onIonChange: e => {\n          inputValues[e.target.id][3] = e.detail.value;\n          setInputValues(inputValues);\n          console.log(inputValues);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }));\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, myPhoto && /*#__PURE__*/React.createElement(IonImg, {\n    height: \"200px\",\n    src: myPhoto.dataUrl,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 26\n    }\n  }))), /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    onClick: () => handleTakePhoto(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    slot: \"icon-only\",\n    src: myPhoto ? cameraReverse : camera,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }))))), result, /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    routerLink: \"./Show-beans\",\n    onClick: () => saveIt(fileName, inputValues, myPhoto, type),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: save,\n    slot: \"icon-only\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    onClick: () => delFunc(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: trash,\n    slot: \"icon-only\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }))))));\n};","map":{"version":3,"sources":["/mnt/Data/Javascript_code/Ionic/coffee-db4/src/components/frontend/add-items.js"],"names":["React","useState","useEffect","useContext","IonPage","IonCard","IonHeader","IonToolbar","IonBackButton","IonContent","IonTitle","IonButtons","IonTextarea","IonCardContent","IonLabel","IonItem","IonInput","IonGrid","IonRow","IonCol","IonIcon","IonButton","IonImg","IonSelect","IonSelectOption","trash","save","camera","cameraReverse","beansDataFileName","beansSettingsFileName","storeData","readPicture","store","useCamera","availableFeatures","CameraResultType","Filesystem","FilesystemDirectory","AddItems","fileName","type","console","log","globalState","state","dispatch","newArray","setNewArray","settings","map","arrayItem","index","concat","dataString","charAt","toUpperCase","slice","pictureString","inputValues","setInputValues","JSON","parse","stringify","photo","getPhoto","myPhoto","setMyPhoto","handleTakePhoto","quality","allowEditing","resultType","DataUrl","height","delFunc","splice","undefined","saveIt","array","objectToSave","reduce","o","objectWithID","data","push","value","folder1","split","readdir","directory","External","path","folder","pathToPhoto","id","toString","beans","brews","result","filter","line","length","e","target","detail","dataUrl"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext } from 'react'\n\nimport { IonPage, IonCard, IonHeader, IonToolbar, IonBackButton, IonContent, IonTitle, IonButtons, IonTextarea,\n    IonCardContent, IonLabel, IonItem, IonInput, IonGrid, IonRow, IonCol, IonIcon, IonButton, IonImg, IonSelect, IonSelectOption} from '@ionic/react'\n\nimport { trash, save, camera, cameraReverse} from 'ionicons/icons'\n\nimport { beansDataFileName, beansSettingsFileName } from '../objects/filenames'\nimport { storeData, readPicture } from '../backend/data'\nimport { store } from '../backend/store'\n\n\nimport { useCamera, availableFeatures } from '@ionic/react-hooks/camera';\nimport { CameraResultType, Filesystem, FilesystemDirectory } from '@capacitor/core'\n\nexport const AddItems = (fileName, type) => {\n    console.log('******************* ADD-ITEMS *******************')\n    const globalState = useContext(store)\n    const { state, dispatch } = globalState\n\n    const [newArray, setNewArray] = useState(state[type].settings.map((arrayItem, index) => arrayItem.concat([index, ''])))\n    \n\n    const dataString = 'set' + type.charAt(0).toUpperCase() + type.slice(1) + 'Data' //returns either 'setBeansData' or 'setBrewsData'\n    const pictureString = 'set' + type.charAt(0).toUpperCase() + type.slice(1) + 'Pics'\n\n    //const [newArray, setNewArray] = useState(array.map((arrayItem, index) => arrayItem.concat([index, ''])))\n    \n\n    // example of arrray ['Bean', true, 0, '']\n    // => Bean is the field title; true if it should be disalayed; 0 is the index; '' will be filled with content eg. Malabar \n    console.log(newArray)\n\n    const [inputValues, setInputValues] = useState(JSON.parse(JSON.stringify(newArray)) )\n\n    let { photo, getPhoto } = useCamera();\n    const  [ myPhoto, setMyPhoto ] = useState(photo)\n\n    const handleTakePhoto = async () => {\n        if(availableFeatures.getPhoto) {\n         await getPhoto({\n            quality: 100,\n            allowEditing: false,\n            resultType: CameraResultType.DataUrl,\n            height: 1000\n            })\n        //console.log('inputvalues:', inputValues)\n        //setNewArray(inputValues.map( (arrayItem, index) => arrayItem[3] = inputValues[index][3]))  That's where I stopped\n        //setMyPhoto(photo)\n        //console.log('photo', photo)\n        }\n    }\n\n    useEffect(() => setMyPhoto(photo), [photo])\n\n    const delFunc = () => {\n        //console.log('newarray1:',newArray)\n        setInputValues(inputValues.map(arrayItem => arrayItem.splice(0,3).concat([''])))\n        console.log('inputvalueSSS:', inputValues)\n        //setNewArray()\n        setMyPhoto(undefined)\n        //console.log('newarray2:',newArray)\n    }\n\n    const saveIt = async (fileName, array, photo, type) => {\n\n        console.log('PHOTO::::::::::', photo)\n\n        // https://stackoverflow.com/questions/42974735/create-object-from-array\n        const objectToSave = array.reduce(( o, arrayItem) => ({...o, [arrayItem[0]]:arrayItem[3] }) , {})\n        const objectWithID = await storeData(fileName, objectToSave, photo)\n        \n        state[type].data.push(objectWithID)\n        dispatch({ type: dataString, value: state[type].data})\n\n        console.log('OBJECT WITH ID!!!!!!!!!', objectWithID)\n        console.log('FILENAME:', fileName)\n\n        const folder1 = fileName.split('/')[0]\n        console.log(await Filesystem.readdir({directory: FilesystemDirectory.External, path: folder1}))\n        debugger\n        if(photo){      //if no picture is done photo will be undefined\n            const folder = fileName.split('/')[0]\n            const pathToPhoto = await readPicture(folder + '/' + objectWithID.id.toString() + '.jpeg')\n            console.log(\"saveIt -> folder + '/' + objectWithID.id.toString() + '.jpeg'\", folder + '/' + objectWithID.id.toString() + '.jpeg')\n            console.log(\"saveIt -> objectWithID.id.toString()\", objectWithID.id.toString())\n            console.log(\"saveIt -> pathToPhoto\", pathToPhoto)\n            \n            if(pathToPhoto){\n                dispatch({type: pictureString, value: pathToPhoto})\n            }\n\n        } \n        // const folder = beansDataFileName.split('/')[0]\n\n\n\n        //does delfunc delete everything even the ''photo''?\n        delFunc()\n\n        /*\n                // Pics Beans\n        if(beansData.length > 0){\n          let tempBeansPics = {}\n          for (let i=0; i<beansData.length; i++){\n            const temp = await readPicture(folder + '/' + beansData[i].id.toString() + '.jpeg')\n            console.log('TEMP', temp)\n            tempBeansPics[beansData[i].id]=temp\n            console.log('TEMPBEANSPICS:',tempBeansPics)\n          }\n          if(Object.keys(tempBeansPics).length > 0){\n            beansPics.push(tempBeansPics)\n          }\n        }\n        */\n\n\n    }\n    \n    console.log('BEANSSETTINGS:',state.beans.settings)\n    console.log('BREWSSETTINGS:',state.brews.settings)\n\n    //heir geht's los\n    const result = inputValues.filter(arrayItem => arrayItem[1])\n                        .map((arrayItem) =>  {\n        if (type==='brews' &&  state.beans.settings.filter( line => (line[0] === arrayItem[0]) && line[1] ).length > 0 && arrayItem[0] !== 'Kommentar') {\n            console.log(state.beans.settings.filter( line => (line[0] === arrayItem[0]) && line[1] ).length  )\n            console.log('test')\n            return (\n                <IonItem>\n                    <IonLabel position='stacked'>{arrayItem[0]}:</IonLabel>\n                    <IonSelect \n                name={arrayItem[0]}\n                id={arrayItem[2]}\n                value={arrayItem[3]}\n                onIonChange={ e => {inputValues[e.target.id][3]=e.detail.value; setInputValues(inputValues); console.log(inputValues)}}>\n                        {state.beans.data.map(line => \n                        <IonSelectOption value={line[arrayItem[0]]}>{line[arrayItem[0]]}</IonSelectOption>)} \n                    </IonSelect>\n                </IonItem>\n            )\n        } else {\n            return(\n        <IonItem>\n            <IonLabel position='stacked'>{arrayItem[0]}:</IonLabel>\n            <IonInput \n                name={arrayItem[0]}\n                id={arrayItem[2]}\n                value={arrayItem[3]}\n                onIonChange={ e => {inputValues[e.target.id][3]=e.detail.value; setInputValues(inputValues); console.log(inputValues)}}\n            ></IonInput>\n        </IonItem> )}  \n        })\n    return(<>\n    <IonGrid>\n        <IonRow>\n            <IonCol>\n            { myPhoto && <IonImg height='200px' src={myPhoto.dataUrl} />}\n            </IonCol>\n        </IonRow>\n        <IonRow>\n            <IonCol>\n            <IonButton color='dark'\n                onClick={() => handleTakePhoto()}>\n                <IonIcon slot='icon-only' src={myPhoto ? cameraReverse : camera}/>\n            </IonButton>\n            </IonCol>\n        </IonRow>\n    </IonGrid>\n    {result}\n    <IonGrid>\n        <IonRow>\n            <IonCol>\n                <IonButton color='dark'\n                        routerLink='./Show-beans'\n                        onClick={() => saveIt(fileName, inputValues, myPhoto, type)} >\n                    <IonIcon icon={save} slot='icon-only'/>\n                </IonButton>\n            </IonCol>\n            <IonCol>\n            <IonButton color='dark'\n                onClick={ () => delFunc()}>\n                    <IonIcon icon={trash} slot='icon-only'/>\n                </IonButton>\n            </IonCol>\n        </IonRow>\n    </IonGrid>\n\n    </>\n    )\n}\n\n"]},"metadata":{},"sourceType":"module"}