{"ast":null,"code":"var _jsxFileName = \"/mnt/Data/Javascript_code/Ionic/coffee-db3/src/components/frontend/sort-items.js\";\nimport React, { useEffect, useLayoutEffect, useContext, useState, useReducer } from 'react';\nimport { IonItem, IonReorder, IonReorderGroup, IonItemDivider, IonCheckbox, IonGrid, IonRow, IonCol, IonLabel, IonContent, IonButton, IonIcon, IonButtons, IonInput, IonTextarea } from '@ionic/react';\nimport { trash, save, close, addCircle } from 'ionicons/icons';\nimport { readSettings, overWriteFile } from '../backend/data';\nimport { store } from '../backend/store'; // fields is the basic array of fields that's available upon installation\n\n/*\nconst fields = [\n    ['Bohne', true],\n    ['RÃ¶ster', true],\n    ['Kommentar', false]]\n\nconst fileName = 'data/beans-settings.data'\n*/\n//let isFileRead = false\n//let fields = []\n\nexport const SortItems = (fileName, defaultSettings) => {\n  const globalState = useContext(store);\n  const {\n    state,\n    dispatch\n  } = globalState;\n  const [ignored, forceUpdate] = useReducer(x => x + 1, 0); // this function will force an updated of the dom\n  //   const [items, setItems] = useState(JSON.parse(JSON.stringify(state.beans.settings)))\n\n  const [tempItems, setTempItems] = useState(JSON.parse(JSON.stringify(state.beans.settings)));\n  const [tempItem, setTempItem] = useState('');\n  const [isFileRead, setIsFileRead] = useState(false); //const [counter, setCounter] = useState([0])\n  //const [counter2, setCounter2] = useState([0])\n  // counter is executed everytime save or cancel is presed. And will then be used to run the useeffect hook on the next render and reload the file setting \n\n  const reducer = (state, action) => {\n    switch (action.type) {\n      case 'swap':\n        return action.value;\n\n      case 'addRow':\n        return state.push([action.itemName, true]);\n\n      case 'delRow':\n        return state.splice(action.index, 1);\n\n      default:\n        throw new Error();\n    }\n  };\n\n  const [items, setItems] = useReducer(reducer, JSON.parse(JSON.stringify(state.beans.settings)));\n  /*\n  const fileRead = async () => {\n      let fields = []\n      console.log('i m in fields')\n      //let fields = []\n      let fileContent =  await readSettings(fileName)\n      console.log('filecontent:', fileContent)\n      if (fileContent) {   //if filename doesn't exist readSettings will return false    \n          fields = JSON.parse(fileContent)\n          console.log('fields:', fields)\n      } else {\n          fields = defaultSettings\n      }\n       setItems(JSON.parse(JSON.stringify(fields)))\n      setTempItems(JSON.parse(JSON.stringify(fields)))\n      setIsFileRead(true)    \n   }\n  if(isFileRead === false){fileRead()}    */\n  //useEffect( () => { console.log('rerender'); }, [isFileRead])\n  //fileRead()  //will be always loaded the page is opened, or on every rerender? Dangerous if rerender!\n\n  const fileSave = async (fileName, object) => {\n    await overWriteFile(fileName, object);\n    dispatch({\n      type: 'setBeansSettings',\n      value: object\n    }); //setIsFileRead(false)\n  };\n\n  const addItem = (newItem, arrayOfItems) => {\n    //const tempVar = items\n    //arrayOfItems.push([newItem, true])\n    //setItems(arrayOfItems)\n    setItems({\n      type: 'addRow',\n      itemName: newItem\n    });\n    setTempItem('');\n    console.log(items);\n  }; // copied from the documentation:\n\n\n  function doReorder(itemsSort, event) {\n    // The `from` and `to` properties contain the index of the item\n    // when the drag started and ended, respectively\n    console.log('Dragged from index', event.detail.from, 'to', event.detail.to); // Finish the reorder and position the item in the DOM based on\n    // where the gesture ended. This method can also be called directly\n    // by the reorder group\n    //event.detail.complete();\n    //event.detail.complete(true);\n\n    const newIndex = event.detail.to;\n    const oldIndex = event.detail.from; //let newItems = [...itemsSort]\n\n    itemsSort = event.detail.complete(itemsSort);\n    setItems(itemsSort); //   console.log('tempits:',tempItems)\n  }\n\n  const delItem = (index, arrayToDeleteFrom) => {\n    arrayToDeleteFrom.splice(index, 1);\n    setItems(arrayToDeleteFrom);\n    forceUpdate();\n  };\n\n  const checkBox = (index, state, arrayToCheck) => {\n    arrayToCheck[index][1] = state;\n    setItems(arrayToCheck);\n    console.log('Checkbox', items);\n  };\n\n  const reset = () => {\n    const temp = JSON.parse(JSON.stringify(state.beans.settings));\n    setItems(() => JSON.parse(JSON.stringify(temp)));\n    console.log(\"reset -> tempItems\", tempItems);\n  }; //useEffect(()=> console.log('USE EFFECT'), [counter])\n\n\n  const displayItems = itemsToDisplay => {\n    const result = itemsToDisplay.map((arrayItem, index) => /*#__PURE__*/React.createElement(IonItem, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 13\n      }\n    }, \" \", console.log('Arrayitem,index', arrayItem, index), /*#__PURE__*/React.createElement(IonCheckbox, {\n      slot: \"start\",\n      color: \"dark\",\n      checked: arrayItem[1],\n      name: index,\n      onIonChange: e => checkBox(e.target.name, e.detail.checked, JSON.parse(JSON.stringify(items))),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(IonLabel, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }\n    }, arrayItem[0]), /*#__PURE__*/React.createElement(IonButton, {\n      color: \"dark\",\n      name: index,\n      onClick: e => delItem(e.target.name, JSON.parse(JSON.stringify(items))),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, \" \", /*#__PURE__*/React.createElement(IonIcon, {\n      icon: trash,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 31\n      }\n    })), /*#__PURE__*/React.createElement(IonReorder, {\n      slot: \"end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }\n    })));\n    return result;\n  };\n\n  console.log('itemsbefore display', items);\n  const toDisplay = displayItems(items);\n  return /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    slot: \"start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, \"Anzeigen\"), /*#__PURE__*/React.createElement(IonLabel, {\n    slot: \"end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, \"Reihenfolge\")), /*#__PURE__*/React.createElement(IonReorderGroup, {\n    disabled: false,\n    onIonItemReorder: e => doReorder(items, e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }\n  }, toDisplay), /*#__PURE__*/React.createElement(IonItem, {\n    class: \"ion-padding\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonInput, {\n    background: \"dark\",\n    placeholder: \"Feld hinzuf\\xFCgen\",\n    onIonChange: e => setTempItem(e.detail.value),\n    value: tempItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    style: {\n      height: '35px',\n      width: '35px'\n    },\n    onClick: () => addItem(tempItem, items),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: addCircle,\n    style: {\n      fontSize: '50px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 22\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    class: \"ion-text-capitalize\",\n    size: \"default\",\n    routerLink: \"./Home\",\n    onClick: () => {\n      fileSave(fileName, items);\n      /*setCounter(counter+1)*/\n\n      ;\n      /*setTempItems(items)*/\n\n      ;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: save,\n    slot: \"start\",\n    size: \"large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 22\n    }\n  }), \"Speichern\")), /*#__PURE__*/React.createElement(IonCol, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    color: \"dark\",\n    class: \"ion-text-capitalize\",\n    size: \"default\",\n    onClick: () => reset(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: close,\n    slot: \"start\",\n    size: \"large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 22\n    }\n  }), \"Abbrechen\")))), \"  \");\n};","map":{"version":3,"sources":["/mnt/Data/Javascript_code/Ionic/coffee-db3/src/components/frontend/sort-items.js"],"names":["React","useEffect","useLayoutEffect","useContext","useState","useReducer","IonItem","IonReorder","IonReorderGroup","IonItemDivider","IonCheckbox","IonGrid","IonRow","IonCol","IonLabel","IonContent","IonButton","IonIcon","IonButtons","IonInput","IonTextarea","trash","save","close","addCircle","readSettings","overWriteFile","store","SortItems","fileName","defaultSettings","globalState","state","dispatch","ignored","forceUpdate","x","tempItems","setTempItems","JSON","parse","stringify","beans","settings","tempItem","setTempItem","isFileRead","setIsFileRead","reducer","action","type","value","push","itemName","splice","index","Error","items","setItems","fileSave","object","addItem","newItem","arrayOfItems","console","log","doReorder","itemsSort","event","detail","from","to","newIndex","oldIndex","complete","delItem","arrayToDeleteFrom","checkBox","arrayToCheck","reset","temp","displayItems","itemsToDisplay","result","map","arrayItem","e","target","name","checked","toDisplay","height","width","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useLayoutEffect, useContext, useState, useReducer} from 'react'\nimport { IonItem, IonReorder, IonReorderGroup, IonItemDivider, IonCheckbox, IonGrid, IonRow, IonCol,\n    IonLabel, IonContent, IonButton, IonIcon, IonButtons, IonInput, IonTextarea } from '@ionic/react'\n\nimport { trash, save, close, addCircle } from 'ionicons/icons'\n\nimport { readSettings, overWriteFile } from '../backend/data'\nimport { store } from '../backend/store'\n\n// fields is the basic array of fields that's available upon installation\n/*\nconst fields = [\n    ['Bohne', true],\n    ['RÃ¶ster', true],\n    ['Kommentar', false]]\n\nconst fileName = 'data/beans-settings.data'\n*/\n//let isFileRead = false\n\n//let fields = []\n\nexport const SortItems = (fileName, defaultSettings) => {\n    \n    const globalState = useContext(store)\n    const { state, dispatch } = globalState\n\n    const [ignored, forceUpdate] = useReducer(x => x + 1, 0) // this function will force an updated of the dom\n //   const [items, setItems] = useState(JSON.parse(JSON.stringify(state.beans.settings)))\n    const [tempItems, setTempItems] = useState(JSON.parse(JSON.stringify(state.beans.settings)))\n    const [tempItem, setTempItem] = useState('')\n    const [isFileRead, setIsFileRead] = useState(false)\n    //const [counter, setCounter] = useState([0])\n    //const [counter2, setCounter2] = useState([0])\n    // counter is executed everytime save or cancel is presed. And will then be used to run the useeffect hook on the next render and reload the file setting \n    \n    const reducer = (state, action) => {\n        switch (action.type){\n            case 'swap':\n                return action.value\n            case 'addRow':\n                return state.push([action.itemName, true])\n            case 'delRow':\n                return state.splice(action.index, 1)\n            default:\n                throw new Error()\n\n        }\n    }\n\n    const [items, setItems] = useReducer(reducer, JSON.parse(JSON.stringify(state.beans.settings)))\n\n    /*\n    const fileRead = async () => {\n        let fields = []\n        console.log('i m in fields')\n        //let fields = []\n        let fileContent =  await readSettings(fileName)\n        console.log('filecontent:', fileContent)\n        if (fileContent) {   //if filename doesn't exist readSettings will return false    \n            fields = JSON.parse(fileContent)\n            console.log('fields:', fields)\n        } else {\n            fields = defaultSettings\n        }\n\n        setItems(JSON.parse(JSON.stringify(fields)))\n        setTempItems(JSON.parse(JSON.stringify(fields)))\n        setIsFileRead(true)    \n\n    }\n    if(isFileRead === false){fileRead()}    */\n    //useEffect( () => { console.log('rerender'); }, [isFileRead])\n\n\n    //fileRead()  //will be always loaded the page is opened, or on every rerender? Dangerous if rerender!\n    \n    const fileSave = async (fileName, object) => {\n        await overWriteFile(fileName, object)\n        dispatch({type: 'setBeansSettings', value: object})\n        //setIsFileRead(false)\n    }\n\n    const addItem = (newItem, arrayOfItems) => {\n        //const tempVar = items\n       \n        //arrayOfItems.push([newItem, true])\n        //setItems(arrayOfItems)\n        setItems({type: 'addRow', itemName: newItem})\n        setTempItem('')\n        console.log(items)\n        \n    }\n\n\n// copied from the documentation:\n    function doReorder(itemsSort, event) {\n\n        // The `from` and `to` properties contain the index of the item\n        // when the drag started and ended, respectively\n        console.log('Dragged from index', event.detail.from, 'to', event.detail.to);\n        // Finish the reorder and position the item in the DOM based on\n        // where the gesture ended. This method can also be called directly\n        // by the reorder group\n        //event.detail.complete();\n        //event.detail.complete(true);\n        const newIndex = event.detail.to\n        const oldIndex = event.detail.from\n        //let newItems = [...itemsSort]\n\n        itemsSort = event.detail.complete(itemsSort)\n        setItems(itemsSort)\n     //   console.log('tempits:',tempItems)\n    }\n    const delItem = (index, arrayToDeleteFrom) => {\n        arrayToDeleteFrom.splice(index, 1)\n        setItems(arrayToDeleteFrom)\n        forceUpdate()\n    }\n\n    const checkBox = (index, state, arrayToCheck) => {\n        arrayToCheck[index][1]=state\n        setItems(arrayToCheck)\n        console.log('Checkbox',items)\n    }\n\n    const reset = () => {\n        const temp = JSON.parse(JSON.stringify(state.beans.settings))\n        setItems( () => JSON.parse(JSON.stringify(temp)))\n        console.log(\"reset -> tempItems\", tempItems)\n        \n    }\n    //useEffect(()=> console.log('USE EFFECT'), [counter])\n\n    const displayItems = (itemsToDisplay) => {\n        const result = itemsToDisplay.map((arrayItem, index) => \n            <IonItem> {console.log('Arrayitem,index', arrayItem, index)}\n                <IonCheckbox slot='start' color='dark' checked={arrayItem[1]}\n                        name={index}\n                        onIonChange={ e => checkBox(e.target.name, e.detail.checked, JSON.parse(JSON.stringify(items)) ) }/>\n                <IonLabel>{arrayItem[0]}</IonLabel>\n                <IonButton color='dark'\n                            name={index}\n                            onClick={ e => delItem(e.target.name, JSON.parse(JSON.stringify(items)) )}\n                            > <IonIcon icon={trash}/></IonButton>\n                <IonReorder slot='end'/>\n            </IonItem>\n            )\n    return result\n    }\n    console.log('itemsbefore display', items)\n    const toDisplay = displayItems(items)\n\n    return (\n        <IonContent>\n            <IonItem>\n                <IonLabel slot='start'>Anzeigen</IonLabel>\n                <IonLabel slot='end'>Reihenfolge</IonLabel>\n            </IonItem>\n            \n            <IonReorderGroup disabled={false}  onIonItemReorder={ (e) => doReorder(items, e)}>\n                {toDisplay}\n            </IonReorderGroup>\n        \n        <IonItem class='ion-padding'>\n            <IonInput background='dark'\n                    placeholder='Feld hinzufÃ¼gen'\n                    onIonChange={e => setTempItem(e.detail.value)} value={tempItem}></IonInput>\n            <IonButton color='dark' style={{height: '35px', width: '35px'}} \n                    onClick={() => addItem(tempItem,items)}>\n                    <IonIcon icon={addCircle} style={{fontSize: '50px'}}  />\n                    </IonButton>\n        </IonItem>\n\n            <IonGrid><IonRow><IonCol>\n            {/* Save */}\n            <IonButton color='dark'\n                    class=\"ion-text-capitalize\"\n                    size='default'\n                    routerLink='./Home'\n                    onClick={() => {fileSave(fileName, items); /*setCounter(counter+1)*/; /*setTempItems(items)*/; }}\n                    ><IonIcon icon={save} slot='start'size='large'/>Speichern</IonButton>\n            </IonCol>\n            <IonCol>\n            {/* Cancel */}          \n            <IonButton color='dark'\n                    class=\"ion-text-capitalize\"\n                    size='default'\n                   \n                    onClick={() => reset()}\n                    ><IonIcon icon={close} slot='start' size='large'/>Abbrechen</IonButton>\n            </IonCol></IonRow></IonGrid>  {/*routerLink='./Home'*/}\n        </IonContent>\n          \n    ) \n}"]},"metadata":{},"sourceType":"module"}